#!/bin/bash
bind-folders()
{
	if [ -d $ISO/$ROOTFS/$ARCH ];then
		if [ -d $ISO/$ROOTFS/$ARCH/sys ];then
			mount --bind /dev $ISO/$ROOTFS/$ARCH/sys
		fi
		if [ -d $ISO/$ROOTFS/$ARCH/tmp ];then
			mount --bind /tmp $ISO/$ROOTFS/$ARCH/tmp
		fi
		if [ -d $ISO/$ROOTFS/$ARCH/dev ];then
			mount --bind /dev $ISO/$ROOTFS/$ARCH/dev
		fi
		if [ -d $ISO/$ROOTFS/$ARCH/proc ];then
			mount --bind /proc $ISO/$ROOTFS/$ARCH/proc
		fi
	fi
}

enter-chroot()
{
	if [ -d $ARCH ];then
		OLDPS1 = $PS1
		PS1 = "(chroot) $PS1" 
		chroot $ISO/$ROOTFS/$ARCH /bin/bash
		PS1 = OLDPS1
	fi
}

case $1 in
"--config")
	if [ -f config/config-$2 ];then
		source config/config-$2
		source config/folders
		bind-folders
		enter-chroot
	fi
;;
esac
